# DeepSeek CLI 对话程序 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 项目名称
DeepSeek CLI Chat - 基于DeepSeek API的命令行对话工具

### 1.2 项目目标
创建一个简单易用的命令行对话程序，让用户能够通过CLI与DeepSeek AI模型进行交互对话，适合学习和日常使用。

### 1.3 目标用户
- Python开发者和学习者
- 需要快速AI对话工具的用户
- 希望了解API集成的初学者

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 CLI对话交互
- **功能描述**: 用户通过命令行输入问题，程序调用DeepSeek API并返回AI回复
- **输入**: 用户文本输入
- **输出**: AI模型回复文本
- **交互方式**: 持续对话模式，支持多轮对话

#### 2.1.2 API密钥管理
- **功能描述**: 安全管理DeepSeek API密钥
- **配置文件**: 独立的配置文件存储API密钥
- **安全性**: 配置文件不纳入版本控制

#### 2.1.3 系统提示词管理
- **功能描述**: 可配置的系统提示词，定制AI行为
- **存储方式**: 独立文件管理
- **可定制性**: 用户可以修改系统提示词

### 2.2 辅助功能

#### 2.2.1 配置管理
- 支持配置文件的读取和验证
- 提供配置示例和说明

#### 2.2.2 错误处理
- API调用失败处理
- 网络连接异常处理
- 配置文件缺失或错误处理

#### 2.2.3 用户体验
- 清晰的命令行界面
- 友好的错误提示
- 简单的退出机制

## 3. 技术规格

### 3.1 技术栈
- **编程语言**: Python 3.8+
- **HTTP客户端**: requests库
- **配置管理**: JSON/YAML格式
- **命令行交互**: 内置input()函数

### 3.2 依赖库
```
requests>=2.28.0
pyyaml>=6.0
```

### 3.3 API规格
- **API提供商**: DeepSeek
- **API版本**: v1
- **认证方式**: Bearer Token
- **请求格式**: JSON

## 4. 项目结构

```
deepseek-cli-chat/
├── main.py              # 主程序入口
├── config.py            # 配置管理模块
├── api_client.py        # DeepSeek API客户端
├── prompt_manager.py    # 系统提示词管理
├── config.json.example  # 配置文件示例
├── prompts/             # 提示词目录
│   └── system.txt       # 默认系统提示词
├── requirements.txt     # 依赖列表
├── README.md           # 使用说明
└── .gitignore          # Git忽略文件
```

## 5. 配置文件设计

### 5.1 config.json
```json
{
  "deepseek": {
    "api_key": "your-api-key-here",
    "base_url": "https://api.deepseek.com/v1",
    "model": "deepseek-chat",
    "max_tokens": 2000,
    "temperature": 0.7
  },
  "app": {
    "system_prompt_file": "prompts/system.txt",
    "max_history": 10
  }
}
```

### 5.2 系统提示词文件
```
你是一个有用的AI助手，请用简洁明了的方式回答用户的问题。
```

## 6. 用户交互流程

### 6.1 启动流程
1. 程序启动
2. 读取配置文件
3. 验证API密钥
4. 加载系统提示词
5. 显示欢迎信息

### 6.2 对话流程
1. 显示输入提示符
2. 用户输入问题
3. 调用DeepSeek API
4. 显示AI回复
5. 返回步骤1（循环）

### 6.3 退出流程
- 用户输入 'quit', 'exit', 或 'q'
- 程序显示再见信息并退出

## 7. 错误处理策略

### 7.1 配置错误
- 配置文件不存在：提示创建配置文件
- API密钥无效：提示检查密钥配置
- 格式错误：显示具体错误位置

### 7.2 API错误
- 网络连接失败：提示检查网络连接
- API限额超出：显示限额信息
- 服务器错误：显示错误代码和建议

### 7.3 用户输入错误
- 空输入：提示重新输入
- 特殊字符处理：自动转义或提示

## 8. 安全考虑

### 8.1 API密钥安全
- 配置文件添加到.gitignore
- 提供配置文件模板
- 避免在日志中记录密钥

### 8.2 输入验证
- 限制输入长度
- 过滤恶意输入
- 验证配置文件格式

## 9. 扩展性设计

### 9.1 未来功能
- 对话历史保存
- 多种AI模型支持
- 插件系统
- Web界面

### 9.2 代码结构
- 模块化设计
- 接口抽象
- 配置驱动

## 10. 测试策略

### 10.1 单元测试
- 配置管理模块测试
- API客户端测试
- 提示词管理测试

### 10.2 集成测试
- 完整对话流程测试
- 错误处理测试
- 配置加载测试

## 11. 部署和使用

### 11.1 安装步骤
1. 克隆项目
2. 安装依赖：`pip install -r requirements.txt`
3. 复制配置文件：`cp config.json.example config.json`
4. 配置API密钥
5. 运行程序：`python main.py`

### 11.2 使用说明
- 启动后直接输入问题
- 输入 'quit' 退出程序
- 修改 `prompts/system.txt` 自定义AI行为

## 12. 成功标准

### 12.1 功能完整性
- ✅ 成功调用DeepSeek API
- ✅ 配置文件正确加载
- ✅ 系统提示词生效
- ✅ 错误处理完善

### 12.2 用户体验
- ✅ 界面简洁清晰
- ✅ 响应速度合理
- ✅ 错误信息友好
- ✅ 文档完整易懂

### 12.3 代码质量
- ✅ 代码结构清晰
- ✅ 注释完整
- ✅ 易于维护和扩展
- ✅ 符合Python编码规范

---

**文档版本**: v1.0  
**创建日期**: 2024年  
**最后更新**: 2024年